---
title: "RMarkdown"
description: "How to use the R version of notebooks"
author: "Andrew Ba Tran"
date: 2018-05-27T21:13:14-05:00
categories: ["R"]
tags: ["R", "rmarkdown", "publishing"]
weight: 1
slug: rmarkdown
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/datatables-binding/datatables.js"></script>
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="/rmarkdown-libs/dt-core/js/jquery.dataTables.min.js"></script>
<script src="/rmarkdown-libs/jszip/jszip.min.js"></script>
<script src="/rmarkdown-libs/pdfmake/pdfmake.min.js"></script>
<script src="/rmarkdown-libs/pdfmake/vfs_fonts.js"></script>
<link href="/rmarkdown-libs/dt-ext-buttons/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="/rmarkdown-libs/dt-ext-buttons/js/dataTables.buttons.min.js"></script>
<script src="/rmarkdown-libs/dt-ext-buttons/js/buttons.flash.min.js"></script>
<script src="/rmarkdown-libs/dt-ext-buttons/js/buttons.html5.min.js"></script>
<script src="/rmarkdown-libs/dt-ext-buttons/js/buttons.colVis.min.js"></script>
<script src="/rmarkdown-libs/dt-ext-buttons/js/buttons.print.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
<p><iframe src="//www.youtube.com/embed/y0mN4HKKxaU?t=3s" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0; encrypted-media" allowfullscreen title="YouTube Video"></iframe></p>
</div>
<p>By now you’ve inadvertently witnessed the different content that R Markdown can help generate:</p>
<ul>
<li>HTML documents that are in each chapter sub folder</li>
<li>Notebooks in which you’ve run code chunks individually</li>
<li>PDFs that you can print out to follow along physically with the course</li>
<li>This entire learn.r-journalism.com website</li>
</ul>
<p>R Markdown is R code + <strong>Markdown</strong>.</p>
<p><img src="/publishing/rmarkdown/images/rmdfiles.png"></p>
<div id="what-is-markdown" class="section level2">
<h2>What is Markdown?</h2>
<p>A very easy way to add formatting to plain text created by John Gruber (of Daring Fireball) as a simple way for non-programming types to write in an easy-to-read format that could be converted directly into HTML.</p>
<p>In the image below, the text on the left was interpreted as HTML on the right.</p>
<p><img src="/publishing/rmarkdown/images/markdown.png"></p>
<p>GitHub has a <a href="https://guides.github.com/features/mastering-markdown/">nice guide</a> on Markdown.</p>
</div>
<div id="r-markdown-.rmd-files" class="section level2">
<h2>R Markdown / .Rmd files</h2>
<p>It’s a simple way to embed chunks of R code (or other languages like Python) in <strong>Markdown</strong> documents.</p>
<p>On one level, it allows you to present your analysis process and results in a format that doesn’t require R to run.</p>
<p>But the code is still there should a researcher or fellow journalist be compelled to reproduce or add to your work.</p>
<p>It’s a version of <a href="https://www-cs-faculty.stanford.edu/~knuth/lp.html"><strong>literate programming</strong></a>. By combining your R code with documentation, it makes your programming more robust, portable, and easier to maintain.</p>
<p>At the click of a button, or the type of a command, you can rerun the code in an R Markdown file to reproduce your work and export the results as a finished report.</p>
<p>R Markdown works thanks to the <a href="https://yihui.name/knitr/"><strong>knitr</strong></a> package, which runs code embedded in Markdown, and <a href="https://pandoc.org/">Pandoc</a>, which then converts Markdown into a bunch of different output formats, like Word, PDF, HTML, etc.</p>
<p>R Markdown supports dozens of static and dynamic output formats including</p>
<ul>
<li>HTML</li>
<li>PDF</li>
<li>MS Word</li>
<li>Beamer</li>
<li>HTML5 slideshows</li>
<li>Tufte-style handouts</li>
<li>Books</li>
<li>Dashboards</li>
<li>Scientific articles (white pages)</li>
<li>Entire websites</li>
</ul>
<hr />
</div>
<div id="formats-useful-to-journalists" class="section level2">
<h2>Formats useful to journalists</h2>
<div id="produce-slick-looking-pdfs" class="section level3">
<h3>Produce slick-looking PDFs</h3>
<p>Exporting your work into PDFs can be effective.</p>
<p><em>For this to work, be sure to get <a href="https://www.latex-project.org/get/">LaTex</a> installed first.</em></p>
<p><img src="/publishing/rmarkdown/images/pdf_output.png"></p>
</div>
<div id="ipython-notebooks" class="section level3">
<h3>IPython Notebooks</h3>
<p>Notebooks are very popular.</p>
<p>This is how pandas and ipython notebooks render when uploaded to GitHub.</p>
<p><img src="/publishing/rmarkdown/images/pythonnotebook.png" height="300"></p>
<p>It renders well and matches the experience of someone coding in that environment.</p>
</div>
<div id="rmd-files-rendered-on-github" class="section level3">
<h3>.Rmd files rendered on Github</h3>
<p>How does an R Markdown file look on GitHub?</p>
<p><img src="/publishing/rmarkdown/images/markdownoutput.png" height="300"></p>
<p>Not well.</p>
<p>Each .Rmd file has its own custom YAML section at the top. These are keywords that when combined with the right packages, lets <strong>knitr</strong> know how to output the .Rmd file. Like <code>toc: toc_float</code> creates an HTML file with a self-generated Table of Contents based on the header titles.</p>
<p>GitHub doesn’t have a way to interpret that so it creates that nested image above and doesn’t even try to make a table of contents.</p>
<p><strong>That’s fine, though</strong></p>
</div>
<div id="output-.rmd-files-to-html" class="section level3">
<h3>Output .Rmd files to HTML</h3>
<p>R Markdown will let you output as HTML, which you can still host on GitHub Pages (which we’ll go over <a href="http://learn.r-journalism.com/en/git/github_pages/github-pages/">later</a>). You may have to include links to the actual page but doing so can be more effective than having a .Rmd file “render” in a GitHub repo.</p>
<p>Rendering in HTML lets you add CSS and JavaScript, allowing for the inclusion of content like the interactive table below.</p>
<pre class="r"><code>library(DT)
library(dplyr)
library(readr)
payroll &lt;- read_csv(&quot;../data/bostonpayroll2013.csv&quot;) %&gt;% 
  select(NAME, TITLE, DEPARTMENT, REGULAR, OVERTIME) %&gt;% 
  filter(row_number()&lt;100)
datatable(payroll, extensions = &#39;Buttons&#39;, options = list(
    dom = &#39;Bfrtip&#39;,
    buttons = c(&#39;copy&#39;, &#39;csv&#39;, &#39;excel&#39;, &#39;pdf&#39;, &#39;print&#39;)
  )
)</code></pre>
<div id="htmlwidget-1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"filter":"none","extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99"],["Darosa, Baltazar","Creaven, Jacqueline D","Cawley, Stephen C","Danilecki, John H","Kervin, Timothy M.","Hosein, Haseeb","Lee, Thomas F","Assad, Mark L","Eversley, Eric V","Crossen, Patrick J","Murray, Timothy J","Fitzpatrick, James J.","Merner, Robert M","Armstrong, Francis W","Stratton, Michael J","Josey, Windell C.","Spillane, Matthew J","Ivens, Paul M","Cruz, Luis A","Lee, Waiman","Joseph, Martin M","Demesmin, Stanley","O'Leary, Thomas J.","Terenzi, Phillip","Greeley, Darrin Patrick","Gillespie, Joseph G.","Dineen, John J","Vickers, Mark W","Quinlan, Richard","Bonds, Jonathan  D","Zelvis, Paul J","Lanchester, Wayne","Webb, Keith A","Smith, Bruce E","Reynolds, Robert T","Cullity, Patrick J","Long, Gregory P","Maguire, Joseph M","Sullivan, Marc","Smith, Sean P","McDonough, John P","Earle, James H","Joseph, Paul M","Hughes, John C.","Ierardi, Anthony D.","Ciccolo, Steven M","McBrien, John F","Connolly, Timothy","Luis, Alexander D","Harrington, Robert P","Feeney, William J","Ridge, William G.","Ciccolo, Robert W","Greland, John P.","Burns, John D Jr","Boyle, Joseph P","Cooper, D. Mark","Horton, Joseph R","Figueroa, Robert F","Kraft, Martin B","Murphy, Paul W","King, Peter","McLaughlin, Paul C","Painten, Paul A","James, Alfred A","Evans, Richard A","Keenan, Donald F","Russell, Paul J.","Dwan, William J","Bailey, Gerard W","Eddings, Marcus C","Davin, John J","Finn, Joseph E.","Lewis, Richard G","Toner, William Reid","Fontana, Gerard T.","Wyse, James J","Hasson, James G","Linskey, Daniel P","Kozmiski, Therese M","Costin, Dennis B","Connolly, Christopher E","Doherty, Michael J.","Larkin, Brian J","Ridge, Robert J","Hopkins, Thomas B.","Dorsainvil, Jean-Gerard","Harrington, Ronald A","Sexton, Richard","McLaughlin, Steven P","Brown, John M","Hernandez, Leonardo","Ryan, Amy E","Burch, Charles K.","Loftus, James Francis","Sadatis Jr, Paul  A.","Caulfield, Ralph W","Flaherty, David E","Driscoll, Jeffery M."],["Police Officer","Police Lieutenant","Police Lieutenant","Police Captain","Police Lieutenant/Hdq Dispatch","Police Lieutenant","Police Captain/DDC","Police Sergeant (Det)","Police Lieutenant (Det)","Police Captain/DDC","Capt.D.D.C-pd Details Section","Police Lieutenant","Police Lieutenant (Det)","Police Captain/DDC","Police Sergeant (Det)","Police Detective","Police Lieutenant/Hdq Dispatch","Police Captain/DDC","Police Lieutenant (Det)","Police Detective","Police Sergeant","Police Sergeant","Police Sergeant (Det)","Police Lieutenant/Hdq Dispatch","Police Lieutenant (Det)","Police Captain/DDC","Police Sergeant","Police Sergeant (Det)","Fire Captain Admin-ADR","Teacher","Police Sergeant/CHF RADIO DISP","Police Captain/DDC","Police Sergeant","Police Sergeant (Det)","Dist Fire Chief","Police Lieutenant (Det)","Police Lieutenant (Det)","Police Sergeant/Hdq Dispatcher","Police Sergeant (Det)","Police Sergeant","Superintendent","PoliceSergeant/SupvCourtCases","Police Sergeant","Police Lieutenant","Police Sergeant/FgrPrt Ev Tech","Police Lieutenant","Police Sergeant","Police Captain","Teacher","Police Lieut (Det)","Police Sergeant (Det)","Police Lieutenant","Police Captain-DDC/HRCD","Police Captain/DDC","Police Sergeant","Police Captain/DDC","Police Lieutenant","Police Sergeant","Police Officer","Police Sergeant/CHF RADIO DISP","Police Sergeant (Det)","Police Lieutenant (Det)","Police Sergeant (Det)","Police Detective","Police Officer","Police Captain/DDC","Police Sergeant (Det)","Police Captain/DDC","Police Sergeant (Det)","Police Lieutenant","Police Sergeant (Det)","Police Captain/DDC","Dep Fire Chief","Police Sergeant (Det)","Police Sergeant","Dep Fire Chief Administration","Police Sergeant (Det)","Police Captain/DDC","Supn-In Chief","Police Lieutenant","District FireChiefAdmn-AdvTech","Police Sergeant/Bomb Squad","Dep Fire Chief","Police Lieutenant (Det)","Police Sergeant","Police Lieutenant (Det)","Police Officer","Dist Fire Chief","Police Captain/DDC","Police Capt/DDC-Hackney Inves","Police Sergeant (Det)","Police Officer","President","Police Officer","District Fire Chief-Technician","Police Sergeant","Police Sergeant","Police Lieutenant","Police Officer"],["Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Fire Department","BPS","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Fire Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","BPS","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","BPS","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Fire Department","Boston Police Department","Boston Police Department","Boston Fire Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Fire Department","Boston Police Department","Boston Fire Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Fire Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Public Library","Boston Police Department","Boston Fire Department","Boston Police Department","Boston Police Department","Boston Police Department","Boston Police Department"],["$66,829","$104,661","$44,632","$121,244","$104,588","$105,261","$106,048","$94,641","$106,564","$122,705","$123,293","$104,179","$109,322","$122,705","$86,675","$75,303","$107,384","$122,705","$106,564","$75,303","$90,275","$92,843","$94,641","$107,099","$108,611","$121,603","$86,381","$94,641","$467","$92,808","$95,371","$122,705","$92,300","$92,719","$0","$106,564","$106,564","$96,805","$94,641","$92,892","$212,663","$87,823","$90,553","$104,577","$89,791","$105,135","$91,674","$113,291","$32,699","$92,098","$94,641","$101,551","$125,053","$122,705","$91,887","$122,705","$105,135","$87,551","$69,798","$86,203","$92,253","$103,547","$92,253","$75,303","$69,294","$122,705","$89,502","$122,705","$94,641","$101,551","$94,641","$122,705","$159,630","$77,381","$93,641","$169,593","$94,597","$122,705","$162,514","$105,135","$155,827","$91,704","$159,630","$106,564","$94,986","$106,564","$69,798","$134,156","$122,705","$117,598","$94,597","$69,798","$176,626","$68,276","$98,115","$95,304","$107,457","$103,189","$69,798"],["$10,473","$47,572","$10,158","$71,198","$88,906","$47,437","$56,418","$79,482","$66,888","$90,319","$34,024","$46,875","$101,684","$70,880","$123,810","$89,947","$82,469","$60,389","$88,019","$70,546","$30,455","$44,754","$75,423","$83,118","$87,593","$63,549","$59,034","$44,759","$0","$0","$78,699","$49,788","$43,580","$87,341","$0","$81,774","$86,164","$80,987","$101,146","$51,746","$0","$47,267","$35,312","$47,778","$38,539","$39,231","$30,046","$63,592","$0","$58,799","$94,217","$85,349","$45,435","$51,264","$29,344","$60,415","$40,804","$55,682","$44,956","$78,807","$85,195","$6,104","$92,547","$111,071","$40,953","$37,488","$73,605","$50,715","$91,000","$73,656","$94,340","$54,517","$38,489","$56,677","$35,293","$18,782","$80,172","$48,057","$0","$38,517","$37,469","$68,620","$32,435","$63,938","$41,719","$66,729","$45,667","$39,991","$46,384","$34,706","$84,660","$39,005","$0","$10,372","$12,753","$42,817","$19,698","$36,769","$34,081"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>NAME<\/th>\n      <th>TITLE<\/th>\n      <th>DEPARTMENT<\/th>\n      <th>REGULAR<\/th>\n      <th>OVERTIME<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
<p>This table was rendered with the <strong>DT</strong> package.</p>
<p>And we don’t have to create the code to display it.</p>
<p>It just worked because the folks who ported the <a href="https://datatables.net/">DataTables jquery plugin</a> over to R wanted to make it seamless.</p>
<p>Pass certain arguments to the function <code>datatable()</code> and you can include buttons that allow reporters to download your tables as CSVs.</p>
<p>Can you imagine the power of that?</p>
<p>You’ve transformed the data collected it and then instead of sending them a huge spreadsheet, you send them a link to your report in which they can filter things out and download the table that they’ve come up with themselves.</p>
<p>You can render other interactives, as well, like <a href="https://learn.r-journalism.com/en/mapping/census_maps/census-maps/">leaflet maps</a>.</p>
</div>
</div>
<div id="links-not-attachments" class="section level2">
<h2>Links not attachments!</h2>
<p>This is a very important development as a journalist.</p>
<p>You see, reporters sometimes aren’t very organized.</p>
<p>How often have you had someone email you asking if you could resend your summarized spreadsheet to them again?</p>
<p>This is what their downloads or desktop folder might look like. It’s easy to see why they might have lost track of it.</p>
<p><img src="/publishing/rmarkdown/images/bad_desktop.png"></p>
<p>Send them links instead!</p>
<div id="host-the-html-of-your-analysis" class="section level3">
<h3>Host the HTML of your analysis</h3>
<ul>
<li>On your internal work network or</li>
<li>On <a href="https://github.com/wpinvestigative/kushner_eb5_census">Github pages</a> (for free)</li>
<li>Share with reporters and editors, let them explore your analysis further</li>
<li>Let them download customized spreadsheets with buttons in the <code>DT</code> <a href="https://rstudio.github.io/DT/extensions.html">(datatable) package</a></li>
<li>If your analysis gets updated, keep the file name then they only have to refresh their link</li>
</ul>
<p>Repeat this process enough and maybe you can start learning how to create <a href="https://rstudio.github.io/shiny/tutorial/">Shiny apps</a> with R.</p>
</div>
</div>
<div id="creating-r-markdown" class="section level1">
<h1>Creating R Markdown</h1>
<p>Follow the instructions below.</p>
<div id="open-a-new-.rmd-file" class="section level3">
<h3>1. Open a new .Rmd file</h3>
<p>at <strong>File &gt; New File &gt; R Markdown</strong>.</p>
<div style="max-width:500px; margin-left:auto; margin-right:auto;">
<img src="/publishing/rmarkdown/images/menu.png">
</div>
<p>Title the R Markdown file and select <strong>HTML</strong> as the output for now.</p>
<div style="max-width:400px; margin-left:auto; margin-right:auto;">
<img src="/publishing/rmarkdown/images/html.png">
</div>
<p>The default file created comes with code already included to give you a guidance on syntax and how it should be structured.</p>
<div id="rmd-structure" class="section level4">
<h4>.Rmd structure</h4>
<div style="width:50%; margin-left:auto; margin-right:auto;">
<img src="/publishing/rmarkdown/images/layout2.png">
</div>
<p>Every .Rmd file starts out the same at the top.</p>
<p><strong>YAML HEADER</strong></p>
<p>Optional section of render options written as <strong>key:value</strong> pairs.</p>
<ul>
<li>At start of file</li>
<li>Between lines of <strong>—</strong> (3 dashes)</li>
</ul>
<p>This is how R knows how to render your files. In the example above, the line<code>output: html_document</code> means it will create an HTML file. If it was <code>output: pdf</code> then you’d get a PDF instead.</p>
<p><em>You can output more than one type at a time, if you want.</em></p>
<p><strong>CODE CHUNKS</strong></p>
<p>In the image above, the R code is in the gray area.</p>
<p>These are chunks of embedded R code. Each chunk:</p>
<ul>
<li>begins with <strong>```{r}</strong> (the back tick key is to the left of 1)</li>
<li>ends with <strong>```</strong></li>
</ul>
<p><strong>TEXT</strong></p>
<p>The rest of it is just the narrative of markdown interspersed in between the R code chunks.</p>
<p>You can also use HTML code instead of Markdown if that’s what you’re more comfortable with.</p>
</div>
</div>
<div id="write-document" class="section level3">
<h3>2. Write document</h3>
<p>Edit the default template by putting in your own code and text.</p>
<p>Intersperse the text with your code to tell a story.</p>
</div>
<div id="b.-label-your-chunks-of-code" class="section level3">
<h3>2b. Label your chunks of code</h3>
<p>It’ll be easier to navigate to in the future with the pull down menu at the bottom of the script window.</p>
<p>It also will be useful to narrow down where code errors might occur.</p>
<p><img src="/publishing/rmarkdown/images/labels.png"></p>
</div>
<div id="c.-notebooks-style" class="section level3">
<h3>2c. Notebooks style</h3>
<p>You can run individual chunks of code before generating the full report to see how it looks.</p>
<p>Click the green arrow next to each chunk.</p>
<p><em>Hopefully, you’ve already been doing this in our coding walkthroughs in class.</em></p>
<p><img src="/publishing/rmarkdown/images/chunky.png"></p>
</div>
<div id="knit-document-to-create-report" class="section level3">
<h3>3. Knit document to create report</h3>
<p>Use knit button (the yarn ball!) at the top left or type <strong>render()</strong> to create the output file(s).</p>
<div style="width:60%; margin-left:auto; margin-right:auto;">
<img src="/publishing/rmarkdown/images/knit_button.png">
</div>
</div>
<div id="b.-check-out-the-build-log" class="section level3">
<h3>3b. Check out the build log</h3>
<p>Warnings and errors will appear in the console below.</p>
<p>Also measures progress by chunks, which is why it’s important to label them.</p>
<p><img src="/publishing/rmarkdown/images/console.png"></p>
</div>
<div id="preview-output-in-rstudio-window" class="section level3">
<h3>4. Preview output in RStudio window</h3>
<p><img src="/publishing/rmarkdown/images/preview.png"></p>
</div>
<div id="output-file" class="section level3">
<h3>5. Output file</h3>
<p>You started with a .Rmd file and clicking knit HTML also generated a .html file.</p>
<div style="width:50%; margin-left:auto; margin-right:auto;">
<img src="/publishing/rmarkdown/images/testpage.png">
</div>
<p>It’s all there in your project folder now.</p>
<p>Next, we’ll go over more specific features in R Markdown files that will give you more control on how its presented.</p>
<hr />
<p><span style="color:gray">© Copyright 2018, Andrew Ba Tran</span></p>
</div>
</div>
